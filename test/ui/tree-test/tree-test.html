<html>
    <head>
        <script src="../../../montage.js" data-package="../.."></script>
        <script type="text/montage-serialization">{
            "owner": {
                "prototype": "ui/tree-test/tree-test"
            },
            "treeController": {
                "prototype": "montage/core/tree-controller",
                "bindings": {
                    "content": {"<->": "@owner.content"}
                }
            },
            "treeEditor": {
                "prototype": "ui/tree-test/tree.reel",
                "properties": {
                    "element": {"#": "treeEditor"},
                    "controller": {"@": "treeController"}
                }
            },
            "treeEditorRow": {
                "prototype": "ui/tree-test/indent",
                "properties": {
                    "element": {"#": "treeEditorRow"}
                },
                "bindings": {
                    "depth": {
                        "<-": "@treeEditor.contentAtCurrentIteration.depth"
                    }
                }
            },
            "expanded": {
                "prototype": "ui/tree-test/checkbox",
                "properties": {
                    "element": {"#": "expanded"},
                    "checked": true
                },
                "bindings": {
                    "checked": {
                        "<->": "@treeEditor.contentAtCurrentIteration.expanded"
                    },
                    "!checked": {
                        "<-": "!enabled"
                    },
                    "enabled": {
                        "<-": "@treeEditor.contentAtCurrentIteration.children.length != 0"
                    }
                }
            },
            "treeEditorLabel": {
                "prototype": "ui/tree-test/text-field",
                "properties": {
                    "element": {"#": "treeEditorLabel"}
                },
                "bindings": {
                    "value": {
                        "<->": "@treeEditor.contentAtCurrentIteration.content.label",
                        "converter": {"@": "stringConverter"}
                    }
                }
            },
            "addChildButton": {
                "prototype": "ui/tree-test/button",
                "properties": {
                    "element": {"#": "addChildButton"}
                },
                "bindings": {
                    "node": {"<-": "@treeEditor.contentAtCurrentIteration"}
                },
                "listeners": [
                    {"type": "action", "listener": {"@": "owner"}}
                ]
            },
            "removeNodeButton": {
                "prototype": "ui/tree-test/button",
                "properties": {
                    "element": {"#": "removeNodeButton"}
                },
                "bindings": {
                    "node": {"<-": "@treeEditor.contentAtCurrentIteration"}
                },
                "listeners": [
                    {"type": "action", "listener": {"@": "owner"}}
                ]
            },
            "swapButton": {
                "prototype": "ui/tree-test/button",
                "properties": {
                    "element": {"#": "swapButton"}
                },
                "listeners": [
                    {"type": "action", "listener": {"@": "owner"}}
                ]
            },
            "treeView": {
                "prototype": "ui/tree-test/tree.reel",
                "properties": {
                    "element": {"#": "treeView"},
                    "controller": {"@": "treeController"}
                }
            },
            "treeViewLabel": {
                "prototype": "montage/ui/text.reel",
                "properties": {
                    "element": {"#": "treeViewLabel"}
                },
                "bindings": {
                    "value": {
                        "<-": "@treeView.contentAtCurrentIteration.content.label",
                        "converter": {"@": "stringConverter"}
                    }
                }
            },
            "treeViewLeader": {
                "prototype": "montage/ui/repetition.reel",
                "properties": {
                    "element": {"#": "treeViewLeader"}
                },
                "bindings": {
                    "content": {
                        "<-": "@treeView.contentAtCurrentIteration.junctions"
                    }
                }
            },
            "treeViewJunction": {
                "prototype": "montage/ui/text.reel",
                "properties": {
                    "element": {"#": "treeViewJunction"}
                },
                "bindings": {
                    "value": {
                        "<-": "@owner.ascii[@treeViewLeader.contentAtCurrentIteration]"
                    }
                }
            },
            "stringConverter": {
                "prototype": "ui/tree-test/tree-test[StringConverter]"
            }
        }</script>
    </head>
    <body>
        <button data-montage-id="swapButton">Swap Trees</button>
        <div data-montage-id="treeEditor">
            <div data-montage-id="treeEditorRow">
                <input type="checkbox" data-montage-id="expanded">
                <input data-montage-id="treeEditorLabel">
                <button data-montage-id="addChildButton">+</button>
                <button data-montage-id="removeNodeButton">-</button>
            </div>
        </div>
        <div style="font-family: monospace" data-montage-id="treeView" float="right">
            <nobr>
                <span data-montage-id="treeViewLeader"><span style="white-space: pre" data-montage-id="treeViewJunction"></span></span>
                <span data-montage-id="treeViewLabel"></span><br>
            </nobr>
        </div>
    </body>
</html>
